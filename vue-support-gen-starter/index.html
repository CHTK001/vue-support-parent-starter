<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<link rel="icon" href="/favicon.ico">
	<title>
		<%= VUE_APP_TITLE %>
	</title>
</head>

<body style="margin: 0; padding: 0; height: 100vh">
	<div id="app"></div>
	<script type="module" src="/src/plugins/log4j/log4j.js"></script>
	<script type="module" src="/src/main.js"></script>

</body>
<script type="text/javascript">
	var dark = window.localStorage.getItem('APP_DARK');
	if (dark) {
		document.documentElement.classList.add("dark")
	}
	((function () {
		var callbacks = [],
			timeLimit = 50,
			open = false;


		if (window.location.hostname !== 'localhost') {
			setInterval(loop, 1);
			return {
				addListener: function (fn) {
					callbacks.push(fn);
				},
				cancleListenr: function (fn) {
					callbacks = callbacks.filter(function (v) {
						return v !== fn;
					});
				}
			}

			
		} else {
			return { addListener(fn) { }, cancleListenr(fn) { } }
		}
		function loop() {
			var startTime = new Date();
			debugger;
			if (new Date() - startTime > timeLimit) {
				if (!open) {
					callbacks.forEach(function (fn) {
						fn.call(null);
					});
				}
				open = true;
				window.stop();
				alert('禁止调试！');
				window.location.reload();
			} else {
				open = false;
			}
		}
	})()).addListener(function () {
		window.location.reload();
	});
</script>

</html>