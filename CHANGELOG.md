# 更新日志

## [未发布]

### 🎉 新增功能

- **配置组管理模块**：新增系统配置分组管理功能
  - 动态配置组管理界面
  - 支持配置组的增删改查操作
  - 配置组图标和状态管理
  - 实时配置更新和启用/禁用控制
  - 与系统设置页面深度集成

### 🔄 重要变更

- **系统设置页面优化**：将静态配置改为动态接口加载
  - `productsConfig` 改为从 `/v2/setting/group/list` 接口获取
  - 支持配置组的动态添加和管理
  - 保留默认配置作为后备方案
  - `default` 和 `group` 配置作为固定值与远程配置合并，确保核心配置始终可用
  - GroupManagement组件恢复为products配置的一部分，保持独立页面功能支持增删改查
   - 调整配置项显示顺序：系统组设置永远在第一位，基础配置在第二位
  - 优化配置加载错误处理

- **人脸检测接口优化**：将人脸检测从异步任务模式改为同步直接调用
  - 移除任务轮询机制，提升响应速度
  - 简化接口调用流程，减少网络请求
  - 优化用户体验，实时返回检测结果

### 🎉 新增功能

- **人脸检测功能模块**：
  - **🖼️ 全屏图片上传**：支持拖拽上传和点击上传图片
  - **🎯 智能人脸检测**：自动检测图片中的人脸位置
  - **📍 关键点标注**：精确标注人脸关键点位置
  - **📊 检测结果统计**：显示检测到的人脸数量信息
  - **🔄 对比展示**：原图与检测结果左右对比显示
  - **💾 结果下载**：支持下载带标注的检测结果图片
  - **⚡ 实时处理**：同步返回检测结果

- **Canvas图像处理**：
  - **🔴 边界框绘制**：红色矩形框标注人脸区域
  - **🟢 关键点绘制**：绿色圆点标注关键特征点
  - **🏷️ 标签显示**：为每个检测到的人脸添加编号标签
  - **🎨 动态渲染**：基于检测结果动态生成标注图像

- **API接口支持**：
  - 新增 `fetchFaceDetection` 同步人脸检测接口
  - 新增 `fetchFaceFeature` 人脸特征提取接口
  - 新增 `fetchFaceRecognizer` 人脸识别接口
  - 新增 `fetchFaceCompare` 人脸对比接口
  - 支持多种人脸检测模型选择

### 🔧 技术实现

- **前端组件**：`face/detect/index.vue`
  - Vue 3 Composition API 架构
  - Element Plus UI组件集成
  - Canvas 2D API 图像处理
  - 响应式状态管理

- **接口文件**：`api/ai/face.ts`
  - TypeScript 类型定义
  - 统一的HTTP请求封装
  - 错误处理机制

### ⚡ 技术优化

- 移除localStorage任务状态缓存
- 简化错误处理逻辑
- 优化内存使用，减少定时器开销
- 提升检测响应速度

### 📋 检测结果格式

```json
{
  "faces": [
    {
      "bbox": {
        "x": 100,
        "y": 150,
        "width": 200,
        "height": 250
      },
      "landmarks": [
        { "x": 120, "y": 180 },
        { "x": 180, "y": 180 }
      ],
      "confidence": 0.95
    }
  ]
}
```

### 🎯 使用场景

- **人脸识别预处理**：为人脸识别系统提供人脸定位
- **图像分析**：分析图片中的人脸分布和特征
- **安全监控**：检测监控画面中的人脸
- **照片处理**：为照片编辑提供人脸区域信息

---

## [1.1.0] - QPS限流配置功能

### 🎉 新增功能

- **QPS限流配置页面**：
  - **🔧 多种限流算法**：支持令牌桶、滑动窗口、Guava限流器
  - **⚡ 灵活阈值配置**：支持每秒/每分钟/每小时/每天的限流配置
  - **🛡️ 拒绝策略**：支持限流惩罚和黑名单策略
  - **⏰ 惩罚机制**：支持临时惩罚和永久惩罚配置
  - **🌐 IP访问控制**：支持白名单和黑名单IP配置
  - **📊 实时预览**：配置实时预览和JSON格式展示
  - **🔄 热应用**：配置保存后立即生效，无需重启服务

- **请求指纹配置功能**：
  - **🔐 多种摘要算法**：支持SHA-256、SHA-1、MD5、SHA-512等算法
  - **🎯 灵活指纹内容**：可选择包含HTTP方法、路径、参数、请求头、请求体
  - **🧂 盐值支持**：支持自定义盐值增强安全性
  - **🔄 去重机制**：支持基于指纹的请求去重，可配置有效期
  - **🚫 重复拦截**：可选择拦截重复请求或仅记录指纹
  - **📝 自定义响应头**：可配置指纹输出的响应头名称
  - **⚡ 热重载**：配置变更后自动清理缓存并生效

- **后端API支持**：
  - 新增 `getFilterConfig` 接口获取ServletFilter配置
  - 新增 `saveFilterConfig` 接口保存ServletFilter配置
  - 支持JSON格式配置存储到数据库
  - 配置热应用到运行中的服务器

### 🔧 技术实现

- **前端组件**：`FilterConfigQpsRateLimit.vue`
  - 响应式配置界面设计
  - 支持多种限流参数配置
  - IP白名单/黑名单管理
  - 配置验证和错误处理

- **后端接口**：
  - `SystemServerSettingController` 新增配置管理接口
  - `SystemServerSettingService` 实现配置存储和应用逻辑
  - 使用Jackson进行JSON序列化/反序列化

### 📋 配置项说明

- **基础配置**：
  - `enabled`: 启用状态
  - `limiterType`: 限流器类型（token/sliding/guava）

- **限流阈值**：
  - `threshold`: 限流阈值数值
  - `timeUnit`: 时间单位（SECOND/MINUTE/HOUR/DAY）

- **拒绝策略**：
  - `rejectStrategy`: 拒绝策略（LIMIT/BLACKLIST）
  - `penaltyDuration`: 惩罚时长
  - `penaltyPermanent`: 是否永久惩罚
  - `penaltyThreshold`: 惩罚阈值

- **IP访问控制**：
  - `whitelistIps`: 白名单IP列表
  - `blacklistIps`: 黑名单IP列表

### 🎯 使用场景

- **API接口限流**：防止恶意请求和系统过载
- **用户访问控制**：基于IP的访问限制
- **服务保护**：保护后端服务免受高并发冲击
- **流量整形**：平滑处理突发流量

### 📈 性能特性

- **低延迟**：配置变更实时生效
- **高并发**：支持高并发场景下的限流控制
- **内存友好**：高效的限流算法实现
- **可扩展**：支持多种限流策略扩展

---

## 历史版本

### [1.0.0] - 基础功能

- 初始版本发布
- 基础服务管理功能
- IP限流和地址限流配置
