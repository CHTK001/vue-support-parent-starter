# 更新日志

本文档记录了项目的所有重要更改。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
并且本项目遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [2.3.1] - 2025-01-14

### 修复

- **双栏导航问题修复**: 解决用户反馈的关键问题
  - 🔧 **图标显示修复**: 修复第一列菜单图标不显示的问题，正确使用useRenderIcon函数
  - 🔗 **路由跳转修复**: 修复点击第二列菜单跳转到首页的问题，正确处理路由路径传递
  - 📐 **布局比例优化**: 调整第一列和第二列的宽度比例，左栏固定64px，右栏自适应
  - 🎨 **样式完善**: 添加边框分隔线和背景色区分，提升视觉层次感

## [2.3.0] - 2025-01-14

### 新增

- **双栏导航重大改进**: 全面优化双栏导航体验
  - 🎯 **第一列图标化**: 第一列仅显示图标，提供更简洁的视觉体验
  - 📋 **第二列重点显示**: 第二列作为主要内容展示区域，支持完整的菜单信息
  - 🔄 **三级菜单支持**: 完整支持三级菜单在双栏导航中的显示和交互
  - ⚡ **智能展开模式**: 新增自动展开和手动展开两种模式
    - **自动展开模式**: 使用div显示灰色分组名称，子菜单直接展开，无折叠功能
    - **手动展开模式**: 保留完整的折叠功能和"展开所有子菜单"选项
  - 🎨 **视觉优化**: 改进分组标题样式，使用灰色背景和更好的层次感
  - 📱 **响应式设计**: 完美适配移动端和桌面端显示

- **配置系统增强**: 双栏导航配置选项
  - 子菜单展开模式选择（自动展开/手动展开）
  - 默认展开所有子菜单开关控制
  - 实时配置更新和预览功能

### 改进

- **组件架构优化**: 重构DoubleNavSidebarItem组件
  - 支持两种渲染模式的条件渲染
  - 优化三级菜单的嵌套显示逻辑
  - 改进样式系统和主题适配
- **用户体验提升**:
  - 第一列图标hover时显示完整菜单名称
  - 自动展开模式下的分组标题更加清晰
  - 手动展开模式保留原有的交互习惯
- **性能优化**: 减少不必要的DOM渲染和事件监听

### 技术改进

- **TypeScript支持**: 完善类型定义和类型安全
- **样式系统**: 使用CSS变量实现更好的主题切换
- **代码结构**: 模块化组件设计，便于维护和扩展

### 配置项

- `doubleNavExpandMode`: 双栏导航展开模式（auto/manual）
- `doubleNavAutoExpandAll`: 自动展开所有子菜单开关

## [2.2.0] - 2025-01-14

### 新增

- **菜单新增标识功能**: 全新的菜单新增标识系统
  - 🏷️ **MenuNewBadge组件**: 用于在菜单项上显示"新增"标识的Vue 3组件
  - ⏰ **时间控制**: 可配置新菜单标识的显示时间限制，支持自定义时间范围
  - 🎨 **样式自定义**: 支持5种标识样式类型（default、primary、success、warning、danger）
  - 🌓 **主题适配**: 完美支持暗色主题和响应式设计
  - ✨ **动画效果**: 内置脉冲动画和光泽效果，提升用户体验
  - 🔧 **全局配置**: 通过系统设置面板全局控制功能开关和参数
  - 🛠️ **工具函数**: 提供MenuNewUtils工具类和便捷函数，简化开发

- **系统设置增强**: 菜单设置配置面板
  - 显示新增菜单标识开关控制
  - 新菜单标识文本自定义配置
  - 新菜单时间限制设置（小时）
  - 实时配置更新和预览功能

- **工具函数库扩展**: MenuNewUtils工具类
  - `shouldShowNewBadge()`: 检查菜单是否应该显示新增标识
  - `addNewBadgeToMenu()`: 为菜单项添加新增标识配置
  - `batchAddNewBadge()`: 批量为菜单列表添加新增标识
  - `createNewMenu()`: 创建带有新增标识的菜单项
  - `withNewBadge()`: 菜单新增标识装饰器（实验性功能）

### 功能特性

- **纯前端实现**: 无需后端支持，完全基于前端配置和时间计算
- **TypeScript支持**: 完整的类型定义和类型安全
- **性能优化**: 使用计算属性和响应式设计，对性能影响极小
- **兼容性**: 支持所有现代浏览器，IE11+
- **文档完善**: 提供详细的使用说明和API文档

### 配置项

- `ShowNewMenu`: 全局开关，控制是否启用新菜单标识功能
- `NewMenuText`: 新菜单标识显示的文本内容
- `NewMenuTimeLimit`: 新菜单标识显示的时间限制（小时）

### 文档

- 📝 新增 [菜单新增标识功能说明](./docs/菜单新增标识功能说明.md)
- 📝 更新 README.md，添加MenuNewBadge组件说明
- 📝 更新 CHANGELOG.md，记录功能变更

## [2.1.0] - 2024-12-19

### 新增

- **Video视频模块**: 全新的视频管理系统
  - 🔍 **视频搜索**: 支持多条件视频搜索和筛选功能
  - 📹 **视频管理**: 完整的视频CRUD操作，包括列表、详情、添加、编辑、删除
  - 🔗 **视频解析**: 支持多平台视频链接解析，包括解析接口管理和历史记录
  - ⚙️ **配置管理**: 灵活的系统配置管理，支持配置导入导出
  - 📊 **数据分析**: 视频播放和使用统计分析，提供数据报表
  - 🎮 **视频播放**: 内置视频播放器支持，支持全屏和嵌入模式
  - 🔒 **权限控制**: 基于角色的权限管理系统
  - 📱 **响应式设计**: 完美适配各种设备和屏幕尺寸

- **Video API接口**: 完整的后端API接口支持
  - 视频管理接口：列表、详情、添加、更新、删除
  - 视频搜索接口：搜索、建议、热门、历史
  - 视频解析接口：解析、接口管理、历史记录
  - 配置管理接口：配置CRUD、同步功能

- **Video类型定义**: 完整的TypeScript类型支持
  - 视频信息类型、搜索请求参数、解析结果类型
  - 配置信息类型、同步配置类型、解析接口类型
  - 系统统计类型、文件上传类型、WebSocket消息类型

- **Video路由配置**: 完整的路由系统配置
  - 采用项目标准路由配置格式，符合RouteConfigsTable规范
  - 支持异步组件加载，提升页面加载性能
  - 配置完整的路由元信息，包括标题、图标、排序等
  - 支持嵌套路由结构，包含视频搜索、解析、管理、配置等子路由
  - 集成权限控制和菜单显示配置
  - 表单验证规则和字段配置类型

- **Video路由配置**: 完整的路由和权限配置
  - 支持嵌套路由和动态路由
  - 基于权限的路由过滤
  - 面包屑导航自动生成
  - 路由守卫和权限检查

### 功能模块

- **视频搜索** (`/video/search`): 关键词搜索、多维度筛选、搜索历史
- **视频管理** (`/video/manage`): 视频列表管理、详情查看、批量操作
- **视频解析** (`/video/parse`): 多平台链接解析、解析历史、接口配置
- **配置管理** (`/video/config`): 系统配置、解析接口配置、同步管理
- **数据分析** (`/video/analytics`): 播放统计、用户行为分析、性能监控
- **系统设置** (`/video/settings`): 参数配置、权限管理、维护工具

### 技术特性

- 基于Vue 3 + TypeScript + Composition API
- 使用Element Plus UI组件库
- 支持WebSocket实时通信
- 完整的错误处理和日志记录
- 支持文件上传和下载
- 响应式设计和移动端适配

## [2.0.4] - 2025-01-17

### 新增

- **ScSwitch**: 新增现代化布局样式 (`modern`)
  - 添加 ModernLayout 组件，提供更现代化的开关设计
  - 支持渐变背景、阴影效果和平滑动画
  - 兼容所有现有属性：尺寸、颜色、图标、文本等
  - 在示例页面中添加现代布局演示

### 改进

- **ScSwitch**: 扩展布局选项，现在支持 `default`、`card`、`slider`、`modern` 四种布局
- **ScSwitchExample**: 更新示例页面，展示新的现代布局效果

## [2.0.3] - 2025-01-17

### 修复

- **ScSearch**: 修复组件垂直居中对齐问题，确保在容器中正确垂直居中显示
- **ScSearch**: 优化表单项和按钮区域的垂直对齐逻辑

### 改进

- **ScSearch**: 改进组件在不同容器中的布局表现
- **HolidayIndex**: 优化搜索区域的布局结构

## [2.0.2] - 2025-01-17

### 修复

- **ScSearch**: 修复 `width` 属性不生效的问题，现在可以正确设置表单项宽度
- **ScSearch**: 优化表单项样式绑定逻辑，避免固定class覆盖自定义宽度

### 改进

- **ScSearch**: 完善width属性文档说明和使用示例
- **ScSearch**: 新增自定义宽度演示页面

## [2.0.1] - 2025-01-17

### 新增

- **ScSearch组件**: 按钮显示模式控制
  - 新增 `buttonMode` 参数，支持 'icon'（只显示图标）和 'text'（显示图标+文字）两种模式
  - 默认模式为 'icon'，提供更简洁的界面
  - 默认只显示搜索和重置按钮，编辑按钮需要手动开启

### 改进

- **ScSearch组件**: 优化默认配置
  - `showEdit` 默认值改为 `false`，减少不必要的按钮显示
  - 更新文档和示例，展示新的按钮模式用法

## [2.0.0] - 2025-01-17

### 新增 (Added)

#### ScSearch 搜索组件 v2.0.0

- **重大重构**: 从 Options API 重构为 Composition API + TypeScript
- **新增表单控件类型**:
  - 时间选择器 (`time`)
  - 时间范围选择器 (`timerange`)
  - 级联选择器 (`cascader`)
  - 开关控件 (`switch`)
  - 复选框组 (`checkbox`)
- **新增功能特性**:
  - 防抖搜索功能 (可配置延迟时间)
  - 表单验证支持 (支持自定义验证规则)
  - v-model 双向绑定支持
  - 组件方法暴露 (`validateForm`, `clearForm`, `setFormData`, `getFormData`, `resetForm`)
  - 自定义插槽支持
  - 管理员权限控制
- **新增配置选项**:
  - `enableDebounce`: 是否启用防抖搜索
  - `debounceDelay`: 防抖延迟时间
  - `showReset`: 是否显示重置按钮
  - `showEdit`: 是否显示编辑按钮
  - `rules`: 表单验证规则
  - `modelValue`: 支持 v-model
- **新增事件**:
  - `update:modelValue`: 表单数据更新事件
  - `search`: 搜索事件
  - `reset`: 重置事件
  - `edit`: 编辑事件

#### WebRTC 监控模块

- **新增 API 函数**: `getRoomHistory` - 获取房间历史数据
  - 支持按房间ID查询历史数据
  - 支持时间范围筛选
  - 返回用户数量变化、持续时间、事件记录等信息

#### Holiday 节假日模块

- **完整模块实现**:
  - 节假日数据展示页面
  - 基于 Element Plus Calendar 的日历组件
  - 节假日数据同步功能
  - API 接口封装
  - 路由配置
  - 模块配置文件

### 改进 (Changed)

#### ScSearch 搜索组件

- **界面优化**:
  - 改进响应式布局，更好适配移动端
  - 优化按钮间距和布局
  - 增强无障碍访问支持
  - 改进键盘导航体验
- **性能优化**:
  - 使用 `computed` 优化计算属性
  - 优化事件监听和内存使用
  - 改进组件渲染性能
- **代码质量**:
  - 完整的 TypeScript 类型定义
  - 更好的代码组织和模块化
  - 增加详细的代码注释

#### 项目结构

- **文档完善**:
  - 新增项目根目录 README.md
  - 新增 ScSearch 组件详细文档
  - 新增组件使用示例文件
  - 新增更新日志文档

### 修复 (Fixed)

#### ScSearch 搜索组件

- 修复表单重置时数据不正确的问题
- 修复展开/收起状态管理问题
- 修复图标显示异常问题
- 修复表单验证时机问题
- 修复响应式布局在小屏幕设备上的显示问题

#### WebRTC 监控模块

- 修复 `getRoomHistory` 函数缺失问题
- 修复 API 导入路径错误 (`@/api/webrtc` → `@/api/webrtc/statistics`)
- 修复语法错误和多余字符问题

### 移除 (Removed)

#### ScSearch 搜索组件

- 移除 Options API 相关代码
- 移除过时的数据绑定方式
- 移除不必要的 Vue 2 兼容代码

### 安全性 (Security)

- 所有新增代码遵循安全最佳实践
- 表单验证增强，防止恶意输入
- 组件暴露的方法进行安全检查

---

## [1.x.x] - 历史版本

### ScSearch 组件 v1.x.x

- 基础功能实现
- 支持基本表单控件类型 (input, select, datepicker, radio, number)
- Options API 实现
- 基础的展开/收起功能
- 简单的搜索和重置功能

### WebRTC 监控模块 v1.x.x

- 基础监控功能
- 系统统计 API
- 房间统计 API
- 实时监控功能

### Holiday 节假日模块 v1.x.x

- 基础页面结构
- 简单的 API 接口定义

---

## 版本说明

### 版本号格式

本项目使用 [语义化版本](https://semver.org/lang/zh-CN/) 格式：`主版本号.次版本号.修订号`

- **主版本号**: 当你做了不兼容的 API 修改
- **次版本号**: 当你做了向下兼容的功能性新增
- **修订号**: 当你做了向下兼容的问题修正

### 更新类型说明

- **新增 (Added)**: 新功能
- **改进 (Changed)**: 对现有功能的更改
- **弃用 (Deprecated)**: 即将移除的功能
- **移除 (Removed)**: 已移除的功能
- **修复 (Fixed)**: 任何 bug 修复
- **安全性 (Security)**: 安全相关的修复和改进

### 重要提示

- 🚨 **重大更新**: 可能包含破坏性更改，升级前请仔细阅读文档
- ✨ **新功能**: 新增的功能特性
- 🐛 **问题修复**: 修复的 bug 和问题
- 📚 **文档更新**: 文档相关的更改
- 🎨 **界面优化**: UI/UX 相关的改进
- ⚡ **性能优化**: 性能相关的改进
- 🔒 **安全更新**: 安全相关的修复

---

## 贡献指南

如果您想为本项目贡献代码，请遵循以下规范：

1. **提交信息格式**:

   ```
   <类型>(<范围>): <描述>

   <详细描述>

   <相关问题>
   ```

2. **类型说明**:
   - `feat`: 新功能
   - `fix`: 修复 bug
   - `docs`: 文档更新
   - `style`: 代码格式调整
   - `refactor`: 代码重构
   - `test`: 测试相关
   - `chore`: 构建过程或辅助工具的变动

3. **范围说明**:
   - `ScSearch`: ScSearch 组件
   - `WebRTC`: WebRTC 监控模块
   - `Holiday`: 节假日模块
   - `docs`: 文档
   - `build`: 构建系统

4. **示例**:

   ```
   feat(ScSearch): 添加级联选择器支持

   - 新增 cascader 类型支持
   - 添加 cascaderProps 配置选项
   - 更新类型定义和文档

   Closes #123
   ```

---

## 联系方式

如有问题或建议，请通过以下方式联系我们：

- 提交 Issue
- 发起 Pull Request
- 联系开发团队

感谢您对本项目的关注和贡献！
